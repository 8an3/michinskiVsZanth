import{r as m,j as t}from"./jsx-runtime-56DGgGmo.js";import{u as f,a as p,r as x}from"./components-ESwiOSE-.js";async function y(){return{name:localStorage.getItem("name")}}const h=e=>new Promise(n=>setTimeout(n,e));async function b({request:e}){const n=await e.formData();if(n.get("intent")==="delete")return localStorage.removeItem("name"),{};const a=n.get("name");return!a||typeof a!="string"?{error:"Name is required"}:(await h(1e3),localStorage.setItem("name",a),{ok:!0})}function S(){var c,u,l;const e=f();let{name:n}=p();const o=m.useRef(null),a=e.state!=="idle",i=(c=e.formData)==null?void 0:c.get("name");i&&typeof i=="string"&&(n=i);const s=(u=e.data)==null?void 0:u.error;return m.useEffect(()=>{var r;s&&((r=o.current)==null||r.focus())},[s]),m.useEffect(()=>{var d;const r=o.current;r&&e.state==="idle"&&((d=e.data)!=null&&d.ok)&&(r.value="")},[(l=e.data)==null?void 0:l.ok,e.state]),t.jsxs("div",{children:[t.jsx("h1",{style:{opacity:a?.5:1},children:n?`Hi ${n}!`:"Form example"}),t.jsxs(e.Form,{method:"post",noValidate:!0,children:[t.jsxs("label",{children:["Name:",t.jsx("input",{ref:o,type:"text",name:"name",required:!0})]}),t.jsx("button",{type:"submit",children:"Submit"})]}),s&&!a?t.jsx("p",{children:s}):null,t.jsx("br",{}),n?t.jsxs(e.Form,{onSubmit:()=>{x.flushSync(()=>{var r;return(r=o.current)==null?void 0:r.focus()})},method:"post",children:[t.jsx("input",{type:"hidden",name:"intent",value:"delete"}),t.jsx("button",{type:"submit",children:"Delete name"})]}):null]})}export{b as clientAction,y as clientLoader,S as default};
